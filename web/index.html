<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <!-- <script src="/public/packages/htmx/htmx.min.js"></script> -->
    <!-- <script src="/public/packages/htmx/htmx-ext-ws.min.js"></script> -->
    <script type="module" src="/public/index.js?={{.}}"></script>
    <script src="/public/wasm_exec.js"></script>
    <script>
        const go = new Go();

        // Providing the environment object, used in WebAssembly.instantiateStreaming.
        // This part goes after "const go = new Go();" declaration.
        go.importObject.env = {
            'add': function (x, y) {
                return x + y
            }
            // ... other functions
        }

        // polyfill if browsers do not support WebAssembly.instantiateStreaming
        if (!WebAssembly.instantiateStreaming) {
            WebAssembly.instantiateStreaming = async (resp, importObject) => {
                const source = await (await resp).arrayBuffer();
                return await WebAssembly.instantiate(source, importObject);
            };
        }

        // fetch wasm
        WebAssembly.instantiateStreaming(fetch("/public/main.wasm"), go.importObject).then((result) => {
            wasm = result.instance
            go.run(wasm); // this also calls main()

            // Calling the multiply function:
            console.log('multiplied two numbers:', wasm.exports.multiply(5, 3));
        }).catch((err) => {
            console.error(err);
        });
    </script>
    <link href="/public/styles.css?v={{.}}" rel="stylesheet" />
    <title>
        cURLy
    </title>
</head>

<body class="p-2 font-fira bg-stone-900 text-stone-50">
    <header>
        <h1 class="font-bold pb-1 text-center">
            <a href="https://github.com/gjtiquia/cURLy" target="_blank">
                cURLy.gjt.io
            </a>
        </h1>
    </header>
    <main>
        <section>
            <p>snake game with cURL</p>
            <p class="min-h-[1.5rem]"></p>
        </section>

        <section>
            <h2 class="font-bold">## Linux & macOS</h2>
            <div>
                <span>$ <code>curl -fsSL cURLy.gjt.io/install.sh | bash</code></span>
                <button data-copy-button
                    class="cursor-pointer text-stone-50/25 hover:text-stone-50/50 border-1 rounded-sm px-2">
                    Copy
                </button>
            </div>
            <p class="min-h-[1.5rem]"></p>
        </section>

        <section>
            <h2 class="font-bold">## Windows</h2>
            <div>
                <span>$ <code>powershell -c "irm curly.gjt.io/install.ps1 | iex"</code></span>
                <button data-copy-button
                    class="cursor-pointer text-stone-50/25 hover:text-stone-50/50 border-1 rounded-sm px-2">
                    Copy
                </button>
            </div>
            <p class="min-h-[1.5rem]"></p>
        </section>
    </main>
</body>

</html>
